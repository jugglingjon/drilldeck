function shuffle(e){var t,r,n;for(n=e.length;n;n--)t=Math.floor(Math.random()*n),r=e[n-1],e[n-1]=e[t],e[t]=r}function minSec(e){e=Math.floor(e);var t=Math.floor(e/60),r=e-60*t;return r<10&&(r="0"+r),t+":"+r}function log(e){console.log(e)}function showCard(){$(".frontCard:first .card-title").text(deck[currentCard].name),$(".frontCard:first .card-type").text(deck[currentCard].type+" Workout"),$.each(deck[currentCard].description,function(){$(".frontCard:first .card-description").append("<p>"+this+"</p>")});var e=deck[currentCard].target.join(", ");$(".frontCard:first .card-description-target").append(e),$(".card").show()}function updateWorkoutTimer(){var e=workTime/timeSecs*100;$(".workout-timer-elapsed").css("width",e+"%")}function startCycle(){if(workTime+(exTime+buffer)<=timeSecs)startBuffer();else if(timeSecs-workTime>=30)globalGapTime=timeSecs-workTime,startBuffer(timeSecs-workTime);else{var e=timeSecs-workTime;log(e+" seconds gap time remain"),end()}}function startBuffer(e){state="buffer",console.log(e);var t=$(".frontCard").first();t.addClass("buffering"),showCard(),$.each(deck[currentCard].frames,function(){t.find(".animation").append($('<img src="img/'+this+'" class="animation-frame">'))}),t.find(".animation-frame:first").addClass("animation-frame-visible"),animationTimer=setInterval(function(){$(".animation-frame-visible").next().length?$(".animation-frame-visible").removeClass("animation-frame-visible").next().addClass("animation-frame-visible"):($(".animation-frame-visible").removeClass("animation-frame-visible"),$(".animation-frame").first().addClass("animation-frame-visible"))},1500),log("buffer starts at "+workTime+" ("+deck[currentCard].name+")"),log("in buffer");var r=0;t.find(".card-timer").knob({readOnly:!0,thickness:.15,max:10,width:120,height:120,step:.1,bgColor:"#E0E0E0",fgColor:"#EF832C",displayInput:!1}),console.log(),t.find(".card-timer").val(buffer-r).trigger("change"),t.find(".card-timer-time").text(buffer-r),bufferTimer=setInterval(function(){r++,workTime++,updateWorkoutTimer(),t.find(".card-timer").val(buffer-r).trigger("change"),t.find(".card-timer-time").text(buffer-r),timeRemaining=buffer-r,r>=buffer&&clearInterval(bufferTimer)},ms),bufferTimeout=window.setTimeout(function(){log("buffer ends at "+workTime),e?startExercise(e-buffer):startExercise()},buffer*ms)}function advanceCards(){$(".card").eq(2).css({transform:"scale(1.2)",opacity:1,transform:"translateX(500px) rotate(30deg)"}),$(".card").eq(1).addClass("frontCard").css({transform:"scale(1)",top:"50px"}),$(".card").eq(0).css({transform:"scale(.9)",top:"20px"}).clone().prependTo(".cards").css({transform:"scale(.8)",top:"-10px"}),setTimeout(function(){$(".card").last().remove()},1e3)}function startExercise(e){var t=exTime;state="exercise",e&&(t=e,console.log("GAP TIME BEING UTILIZED ("+t+")"));var r=$(".frontCard").first();r.removeClass("buffering"),log("exercise starts at "+workTime+" ("+deck[currentCard].name+")"),log("exercising"),r.find(".card-timer").trigger("configure",{readOnly:!0,max:exTime}),r.find("canvas").fadeIn();var n=0;r.find(".card-timer").val(exTime-n).trigger("change"),r.find(".card-timer-time").text(minSec(exTime-n)),currentTimer=setInterval(function(){n++,workTime++,updateWorkoutTimer(),r.find(".card-timer").val(exTime-n).trigger("change"),r.find(".card-timer-time").text(minSec(exTime-n)),timeRemaining=exTime-n,n>=t&&(clearInterval(currentTimer),clearInterval(animationTimer))},ms),exerciseTimeout=window.setTimeout(function(){log("exercise ends at "+workTime),currentCard<deck.length-1?currentCard++:deckCycle<=3?(shuffle(deck),currentCard=0,deckCycle++):end(),advanceCards(),startCycle()},t*ms)}function end(){switch(log("done"),workTime>=timeSecs-1&&workTime<=timeSecs+1&&(workTime=timeSecs),parseInt(getChecked('[name="sweat-set"]')[0])/30){case 1:$(".endBox-intensity-title").text("Low"),$(".endBox-intensity-drops").html('<i class="ddicon ddicon-drop"></i>');break;case 2:$(".endBox-intensity-title").text("Medium"),$(".endBox-intensity-drops").html('<i class="ddicon ddicon-drop"></i><i class="ddicon ddicon-drop"></i>');break;case 3:$(".endBox-intensity-title").text("High"),$(".endBox-intensity-drops").html('<i class="ddicon ddicon-drop"></i><i class="ddicon ddicon-drop"></i><i class="ddicon ddicon-drop"></i>')}$(".endBox-time-number").text(minSec(workTime)),$(".endBox-focusArea-image-overlay").hide(),$.each(getChecked('[name="body-set"]'),function(){$(".endBox-focusArea-image-overlay.endBox-focusArea-image-"+this).show()}),$("#endModal").modal(),$("#endModal").on("shown.bs.modal",function(){deckCycle=1,clearInterval(currentTimer),clearInterval(bufferTimer),clearInterval(animationTimer),window.clearTimeout(exerciseTimeout),window.clearTimeout(bufferTimeout),globalGapTime=null,$(".animation").empty(),workTime=0,updateWorkoutTimer(),$(".workout").hide(),$(".settings").show()})}function getChecked(e){var t=[];return $(e).filter(":checked").each(function(){t.push($(this).attr("data-inputValue"))}),t}function combineArrays(e){var t=[];return $.each(e,function(){$.each(cards[this],function(){t.push(this)})}),t}var currentCard=0,deckCycle=1,cards={upper:[{name:"Chair Dips",frames:["Chair-sit-1.png","Chair-sit-2.png"],type:"Upper Body",description:["Hold onto chair edge. Slide your butt off the seat and hold yourself up with your arms straight.","Bend your elbows as you lower your body for 2 seconds. Push up, straightening your arms for 2 seconds."],target:["Triceps","Forearms","Chest","Shoulders"]},{name:"Push-ups",frames:["Push-Ups-1.png","Push-Ups-2.png"],type:"Upper Body",description:["Lay face down on the floor.","Tuck hands under shoulders and push up.","Lower your body until your chest almost touches the floor, keeping your back flat, and push back up."],target:["Deltoids","Triceps","Abdominals"]},{name:"Arm Circles",frames:["Arm-Circle-Backward-1.png","Arm-Circle-Backward-2.png","Arm-Circle-Backward-3.png","Arm-Circle-Backward-4.png","Arm-Circle-Forward-1.png","Arm-Circle-Forward-2.png","Arm-Circle-Forward-3.png","Arm-Circle-Forward-4.png"],type:"Upper Body",description:["Standing, extend arms out to your side.","Make small circles with your outstretched arms for preferred amount of time.","Repeat in the opposite direction for the same amount of time."],target:["Deltoids","Rotator Cuff Muscles"]},{name:"Reverse Plank",frames:["Reverse-Plank-1.png","Reverse-Plank-2.png"],type:"Upper Body",description:["Sit with your legs extended in front of you, and place your palms on the ground below your shoulders.","Push up into a reverse plank with your arms and legs extended, squeezing butt and thighs."],target:["Deltoids","Lower Back"]}],core:[{name:"Plank",frames:["Plank.png"],type:"Core",description:["Lay face down on floor. Push up onto forearms, squeezing abs and glutes.","Keep your neck and spine in a neutral position, looking at a spot about 1 foot beyond your hands."],target:["Abdominals","Obliques"]},{name:"Heel Touches",frames:["Heel-Touch-1.png","Heel-Touch-2.png"],type:"Core",description:["Lay on back with your arms by your side. Raise shoulders slightly on the ground.","With your core engaged, reach your right hand down to your right foot and then back to center.","Repeat with left hand and left foot. Do preferred number of reps on each side."],target:["Abdominals","Obliques"]},{name:"Reverse Crunches",frames:["Reverse-Crunch-1.png","Reverse-Crunch-2.png"],type:"Core",description:["Lay on your back. Lift your legs so they form a 90° angle with the floor, keeping feet together.","While inhaling, move your legs towards your torso as you roll your pelvis backwards and you raise your hips on the floor.","Hold for 1 second, then exhale while moving back to starting position."],target:["Abdominals"]},{name:"Core Twists",frames:["Core-Twist-1.png","Core-Twist-2.png","Core-Twist-3.png","Core-Twist-4.png","Core-Twist-5.png"],type:"Core",description:["Sit on the floor with your knees bent and your feet flat on the ground.","Tilt back so your torso is at a 45° angle to floor and your feet are slightly lifted.","Lace your hands and rotate arms from left to right for each rep."],target:["Abdominals","Obliques"]}],lower:[{name:"High Knees",frames:["Knee-High-1.png","Knee-High-2.png"],type:"Lower Body",description:["Quickly jump from one foot to the other, lifting each knee to hip height."],target:["Quadriceps","Calves","Glutes"]},{name:"Wall-sit",frames:["Wall-sit-1.png","Wall-sit-2.png"],type:"Lower Body",description:["Stand with your back against a wall and your feet about 2 feet in front of you.","Slide down until knees are at a 90° angle. Hold in place, keeping abs tight."],target:["Quadriceps","Hamstrings"]},{name:"Lunges",frames:["Lunges-1.png","Lunges-2.png","Lunges-3.png","Lunges-4.png"],type:"Lower Body",description:["Step forward with one leg, lowering hips until both knees are at a 90° angle.","Be sure your front knee is directly above your ankle and the other knee isn’t touching the floor.","Push back up to starting position and repeat on the other side. Do preferred number of reps on each side."],target:["Hamstrings","Quadriceps","Glutes"]},{name:"Squats",frames:["Squats-1.png","Squats-2.png"],type:"Lower Body",description:["Stand up straight with feet hip-width apart. Slowly lower your body by pushing hips back and bending knees, sinking your weight into heels.","Keep your spine straight and never let your knees go over your toes.","Pause and then lift back up in a controlled movement to the starting position."],target:["Hip Flexors","Glutes","Hamstrings","Calves","Quadriceps","Adductors"]}],fullbody:[{name:"Burpees",frames:["Burpee-1.png","Burpee-2.png","Burpee-3.png","Burpee-4.png","Burpee-5.png"],type:"Full Body",description:["Bend down to touch the floor and kick your feet back so you are in push-up position.","Do a push-up.","Stand up, then jump into the air reaching your arms overhead."],target:["Full Body"]},{name:"Star Jumps",frames:["Star-Jump-1.png","Star-Jump-2.png","Star-Jump-3.png"],type:"Full Body",description:["Jump to fully extend your body, stretching out your legs and arms.","As you land, bring your limbs back in and slightly bend your knees to absorb the impact through your legs.","Quickly jump back to standing position and repeat in-air motions."],target:["Full Body"]},{name:"Jumping Jacks",frames:["Jumping-Jacks-1.png","Jumping-Jacks-2.png","Jumping-Jacks-3.png"],type:"Full Body",description:["Slightly bend your knees and jump up while moving your legs outward and raising your arms overhead.","Quickly jump back to standing position."],target:["Full Body"]},{name:"Climber",frames:["Climber-1.png","Climber-2.png","Climber-3.png","Climber-4.png"],type:"Full Body",description:["Start in push-up position. Lift your right foot on the floor and slowly raise your knee as close to your chest as you can, keeping your back straight.","Return to the starting position and repeat with your left leg. Do preferred number of reps on each side."],target:["Full Body"]}]},deck=[],timeMins=5,buffer=10,exTime=30,ms=1e3,timeRemaining=0,donutSeconds=0;state="buffer",globalGapTime=null;var timeSecs=60*timeMins,bufferTimer,currentTimer,exerciseTimeout,bufferTimeout,animationTimer,workTime=0;$(document).ready(function(){function e(){n.enable(),document.removeEventListener("touchstart",e,!1)}function t(e){$.each(e,function(){$(".set-input").eq(this).attr("checked","checked")})}function r(){$("input[name=time-set]:checked").length>=1&&$("input[name=sweat-set]:checked").length>=1&&$("input[name=body-set]:checked").length>=1?$("#btn-go").removeClass("disabled").text("I'm ready, let's go!"):$("#btn-go").addClass("disabled").text("Pick your settings")}var n=new NoSleep;e(),$("#disclaimerModal .btn").click(function(){localStorage.setItem("DDdisclaimer","true")}),localStorage.getItem("DDdisclaimer")||$("#disclaimerModal").modal(),localStorage.getItem("DDsettings")&&t(JSON.parse(localStorage.getItem("DDsettings"))),r(),$(".set-input").change(function(){r()}),$("body").on("click",'#btn-go:not(".disabled")',function(){var e=[];$(".set-input:checked").each(function(){e.push($(".set-input").index($(this)))}),localStorage.setItem("DDsettings",JSON.stringify(e)),$(".settings").fadeOut(function(){$(".workout").fadeIn(function(){deck=combineArrays(getChecked('[name="body-set"]')),shuffle(deck),timeMins=parseInt(getChecked('[name="time-set"]')[0]),exTime=parseInt(getChecked('[name="sweat-set"]')[0]),timeSecs=60*timeMins,startCycle()})})}),$("#btn-skip").click(function(){clearInterval(currentTimer),clearInterval(bufferTimer),clearInterval(animationTimer),window.clearTimeout(exerciseTimeout),window.clearTimeout(bufferTimeout),log("exercise ends at "+workTime),deck.splice(currentCard,1),0==deck.length&&end(),currentCard<deck.length-1?currentCard++:(shuffle(deck),currentCard=0,deckCycle++),advanceCards(),startCycle()}),$("#btn-pause").click(function(){clearInterval(currentTimer),clearInterval(bufferTimer),window.clearTimeout(exerciseTimeout),window.clearTimeout(bufferTimeout),$("#pauseModal").modal({backdrop:"static"}),console.log(state,timeRemaining)}),$("#btn-resume").click(function(){var e=$(".frontCard").first(),t=timeRemaining;if("buffer"==state){var r=0;e.find(".card-timer").val(t-r).trigger("change"),e.find(".card-timer-time").text(minSec(t-r)),bufferTimer=setInterval(function(){r++,workTime++,updateWorkoutTimer(),e.find(".card-timer").val(t-r).trigger("change"),e.find(".card-timer-time").text(minSec(t-r)),timeRemaining=t-r,r>=t&&clearInterval(bufferTimer)},ms),bufferTimeout=window.setTimeout(function(){log("buffer ends at "+workTime),globalGapTime?startExercise(globalGapTime-buffer):startExercise()},t*ms)}else{var r=0;e.find(".card-timer").val(t-r).trigger("change"),e.find(".card-timer-time").text(minSec(t-r)),currentTimer=setInterval(function(){r++,workTime++,updateWorkoutTimer(),e.find(".card-timer").val(t-r).trigger("change"),e.find(".card-timer-time").text(minSec(t-r)),timeRemaining=exTime-r,r>=t&&(clearInterval(currentTimer),clearInterval(animationTimer))},ms),exerciseTimeout=window.setTimeout(function(){log("exercise ends at "+workTime),currentCard<deck.length-1?currentCard++:deckCycle<=3?(shuffle(deck),currentCard=0,deckCycle++):end(),advanceCards(),startCycle()},t*ms)}}),$(".btn-end").click(function(){return end(),!1}),$(".btn-pause-end").click(function(){return $("#pauseModal").modal("hide"),end(),!1}),$(".cards").on("click",".card-title",function(){$(".frontCard").first().find(".card-description").slideToggle()})});